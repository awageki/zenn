---
title: "Railsã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†æ–¹æ³•"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Rails", "Ruby"]
published: false
---

Rails ã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¦ã¿ãŸã®ã§ã€ãƒ¡ãƒ¢ã¨ã—ã¦æ®‹ã—ã¦ãŠãã¾ã™ã€‚

## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

```ruby
require 'uri'

def validate_email(email)
    return if email.blank? # 1
    format_email = email.gsub(/[[:space:]]/, '') # 2
    raise "error" unless URI::MailTo::EMAIL_REGEXP.match?(email) # 3
    format_email # 4
end
```

## å†…å®¹

validate_email ã®ä¸­ã§ã¯ä¸‹è¨˜ã®æµã‚Œã§å‡¦ç†ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚

1. email ãŒç©ºã‹ã©ã†ã‹åˆ¤å®šã€ç©ºã®å ´åˆ
2. email ã«ã‚¹ãƒšãƒ¼ã‚¹ã¨æ”¹è¡ŒãŒå«ã¾ã‚Œã¦ã„ãŸå ´åˆã€å–ã‚Šé™¤ã
3. ï¼  ãŒå«ã¾ã‚Œã¦ã„ãªã„ãªã©ã€email ãŒå½¢å¼ã«ããã‚ãªã„å ´åˆã€ä¾‹å¤–ã§è¿”ã™
4. å½¢å¼ã«å•é¡Œãªã„å ´åˆã€2 ã§æ•´å½¢ã—ãŸçŠ¶æ…‹ã® email ã‚’è¿”ã™

```ruby
raise "error" unless URI::MailTo::EMAIL_REGEXP.match?(email)
```

email ã®å½¢å¼ãƒã‚§ãƒƒã‚¯ã«ã¯ Ruby æ¨™æº–ã§ç”¨æ„ã•ã‚Œã¦ã„ã‚‹`URI::MailTo::EMAIL_REGEXP`ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚
ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€email ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£è¦è¡¨ç¾ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
æ¨™æº–ã§æº–å‚™ã•ã‚Œã¦ã‚‹ã®ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚
https://github.com/ruby/ruby/blob/dafbaabc04e5a2d34045af78629a7249fd8c7481/lib/uri/mailto.rb#L55
