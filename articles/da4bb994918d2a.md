---
title: "Rubyã§Googleãƒ‰ãƒ©ã‚¤ãƒ–ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

## ã‚„ã‚ŠãŸã„ã“ã¨

å¤–éƒ¨ API ã‚’å©ã„ã¦ç”Ÿæˆã—ãŸç”»åƒã‚’ä¸€æ‹¬ã§ Google ãƒ‰ãƒ©ã‚¤ãƒ–ã«å…¥ã‚Œã‚‹éš›ã«ã€Google API ã‚’ä½¿ã†ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å©ãã“ã¨ã§å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯ã€Google ãƒ‰ãƒ©ã‚¤ãƒ–ã«ä¿å­˜ã™ã‚‹éš›ã®äº‹å‰æº–å‚™ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚
ãªãŠã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ Ruby ã§å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

## ç’°å¢ƒ

Ruby 3.1.3

ã¾ãŸã€Ruby ã§å®Ÿè£…ã™ã‚‹ã«ã‚ãŸã‚Š Google ãŒå…¬å¼ã§å‡ºã—ã¦ã„ã‚‹ä¸‹è¨˜ã® gem ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

- [google/apis/drive_v3](https://github.com/googleapis/google-api-ruby-client)
- [googleauth](https://github.com/googleapis/google-auth-library-ruby)

## æ‰‹é †

1. Google ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹

2. ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ Google ãƒ‰ãƒ©ã‚¤ãƒ–ã® API ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹

3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ç·¨é›†æ¨©é™ã‚’æŒã¤ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹

4. ä½œæˆã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ç´ã¤ãã‚­ãƒ¼ã‚’ä½œæˆã—ã¦ json å½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦æ‰€å®šã®ç®‡æ‰€ã«é…ç½®ã™ã‚‹ï¼ˆä»Šå›ã¯ãƒ«ãƒ¼ãƒˆç›´ä¸‹ï¼‰

5. Google ãƒ‰ãƒ©ã‚¤ãƒ–ã«ä¿å­˜ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã€ãƒ•ã‚©ãƒ«ãƒ€ ID ã‚’æ§ãˆã¦ãŠã

6. ä½œæˆã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒç™»éŒ²ã§ãã‚‹ã‚ˆã†ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å…±æœ‰ã™ã‚‹

7. Ruby ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹

```shell
$ ruby test.rb
```

9. ç¢ºèª

### ã‚½ãƒ¼ã‚¹

```ruby
require 'google/apis/drive_v3'
require 'googleauth'

authorizer = Google::Auth::ServiceAccountCredentials.make_creds(
  json_key_io: File.open('./client_secret.json'),
  scope: 'https://www.googleapis.com/auth/drive')
authorizer.fetch_access_token!
drive = Google::Apis::DriveV3::DriveService.new
drive.authorization = authorizer

# Upload a file
metadata = Google::Apis::DriveV3::File.new(name: 'sample.png', parents: ['Googleãƒ‰ãƒ©ã‚¤ãƒ–ã®ãƒ•ã‚©ãƒ«ãƒ€ID'])
drive.create_file(metadata, upload_source: './sample.png', content_type: 'image/png')
```

### ãƒ¡ãƒ¢

å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã®å ´åˆã€`creae_file`ã®å¼•æ•°ã«`supports_team_drives: true`ã‚’è¿½åŠ ã™ã‚‹

```ruby
drive.create_file(metadata, upload_source: './sample.png', supports_team_drives: true, ontent_type: 'image/png')
```
